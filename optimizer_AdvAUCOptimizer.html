<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Tutorials</title>
    <!-- SEO Meta Tags-->
    <meta name="description" content="Around - Multipurpose Bootstrap Template">
    <meta name="keywords" content="bootstrap, business, consulting, coworking space, services, creative agency, dashboard, e-commerce, mobile app showcase, multipurpose, product landing, shop, software, ui kit, web studio, landing, html5, css3, javascript, gallery, slider, touch, creative">
    <meta name="author" content="Createx Studio">
    <!-- Viewport-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon and Touch Icons-->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="mask-icon" color="#5bbad5" href="safari-pinned-tab.svg">
    <meta name="msapplication-TileColor" content="#766df4">
    <meta name="theme-color" content="#ffffff">
    <!-- Page loading styles-->
    <style>
      .page-loading {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        -webkit-transition: all .4s .2s ease-in-out;
        transition: all .4s .2s ease-in-out;
        background-color: #fff;
        opacity: 0;
        visibility: hidden;
        z-index: 9999;
      }
      .page-loading.active {
        opacity: 1;
        visibility: visible;
      }
      .page-loading-inner {
        position: absolute;
        top: 50%;
        left: 0;
        width: 100%;
        text-align: center;
        -webkit-transform: translateY(-50%);
        transform: translateY(-50%);
        -webkit-transition: opacity .2s ease-in-out;
        transition: opacity .2s ease-in-out;
        opacity: 0;
      }
      .page-loading.active > .page-loading-inner {
        opacity: 1;
      }
      .page-loading-inner > span {
        display: block;
        font-family: 'Inter', sans-serif;
        font-size: 1rem;
        font-weight: normal;
        color: #737491;
      }
      .page-spinner {
        display: inline-block;
        width: 2.75rem;
        height: 2.75rem;
        margin-bottom: .75rem;
        vertical-align: text-bottom;
        border: .15em solid #766df4;
        border-right-color: transparent;
        border-radius: 50%;
        -webkit-animation: spinner .75s linear infinite;
        animation: spinner .75s linear infinite;
      }
      @-webkit-keyframes spinner {
        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg);
        }
      }
      @keyframes spinner {
        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg);
        }
      }
      
    </style>
    <!-- Page loading scripts-->
    <script>

function showHide(element) {
    var list = element.parentNode.nextElementSibling;

    if (list.style.display === "block") {
        list.style.display = "none";
        element.innerHTML = "[+]&nbsp&nbsp"
    } else {
        list.style.display = "block";
        element.innerHTML = "[-]&nbsp&nbsp"
    }
}
    </script>
    <script>
      window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], }, chtml: { scale: 0.8 }};
    </script>
    <!-- Vendor Styles-->
    <!-- <link rel="stylesheet" media="screen" href="vendor/simplebar/dist/simplebar.min.css"/> -->
    <!-- Main Theme Styles + Bootstrap-->
    <link rel="stylesheet" media="screen" href="css/theme.min.css">
    <!-- Code Theme Styles -->
    <link rel="stylesheet" media="screen" href="css/code.css">
    <link rel="stylesheet" media="screen" href="css/prism.css">
    <!-- Google Tag Manager-->
    <script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-WKV3GT5');
    </script>
  </head>

  <body class="is-sidebar">

    <noscript>
      <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WKV3GT5" height="0" width="0" style="display: none; visibility: hidden;"></iframe>
    </noscript>
    <!-- Page loading spinner-->
    <div class="page-loading active">
      <div class="page-loading-inner">
        <div class="page-spinner"></div><span>Loading...</span>
      </div>
    </div>

    <div>
    <main class="page-wrapper">
      <!-- Navbar (Solid background + shadow)-->
      <!-- Remove "navbar-sticky" class to make navigation bar scrollable with the page.-->
      <header class="header navbar navbar-expand-lg navbar-light bg-light navbar-sticky">
        <div class="navbar-search bg-light">
          <div class="container d-flex flex-nowrap align-items-center"><i class="ai-search fs-xl"></i>
            <input class="form-control form-control-xl navbar-search-field" type="text" placeholder="Search site">
            <div class="d-flex align-items-center"><span class="text-muted fs-xs mt-1 d-none d-sm-inline">Close</span>
              <button class="btn-close p-2" type="button" data-bs-toggle="search"></button>
            </div>
          </div>
        </div>
        <div class="container px-0 px-xl-3">
          <button class="navbar-toggler ms-n2 me-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#primaryMenu"><span class="navbar-toggler-icon"></span></button><a class="navbar-brand flex-shrink-0 order-lg-1 mx-auto ms-lg-0 pe-lg-2 me-lg-4" href="index.html"><img class="d-none d-lg-block" src="img/logo/Xcurve-logo.png" alt="XCurve" width="153"><img class="d-lg-none" src="img/logo/Xcurve-logo.png" alt="XCurve" width="58"></a>
          <!--<div class="d-flex align-items-center order-lg-3 ms-lg-auto"><a class="btn btn-primary d-lg-inline-block d-none" href="demo-personal-portfolio.html#modal-contact" data-bs-toggle="modal">Contact Us</a><a class="btn btn-sm btn-primary d-lg-none d-inline-block" href="demo-personal-portfolio.html#modal-contact" data-bs-toggle="modal">Contact Us</a></div>-->
          <div class="offcanvas offcanvas-collapse order-lg-2" id="primaryMenu">
            <div class="offcanvas-header navbar-shadow">
              <h5 class="mt-1 mb-0">Menu</h5>
              <button class="btn-close lead" type="button" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
              <!-- Menu-->
              <ul class="navbar-nav">
                <li class="nav-item dropdown dropdown-mega"><a class="nav-link" href="index.html">Home</a>
                </li>
                <li class="nav-item dropdown dropdown-mega active"><a class="nav-link dropdown-toggle" href="tutorials.html">Documentation</a>
                </li>
                <!-- <li class="nav-item dropdown dropdown-mega"><a class="nav-link dropdown-toggle" href="doc_dataset.html">Documentation</a></li> -->
                <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="datasets.html">Datasets</a></li>
                <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="research.html">Research</a></li>
                <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="about.html">Team</a>

                </li>
                <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="lastest_news.html">Latest News</a></li>
                <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="https://github.com/statusrank/XCurve">Github</a>
                  <!--<ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="https://github.com/statusrank/XCurve/blob/master/README.md">
                        <div class="d-flex align-items-center">
                          <div class="fs-xl text-muted"><i class="ai-file-text"></i></div>
                          <div class="ps-3"><span class="d-block text-heading">Documentation</span><small class="d-block text-muted">Kick-start customization</small></div>
                        </div></a></li>
                    <li class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="docs/changelog.html">
                        <div class="d-flex align-items-center">
                          <div class="fs-xl text-muted"><i class="ai-edit"></i></div>
                          <div class="ps-3"><span class="d-block text-heading">Changelog<span class="badge bg-success ms-2">v2.4.0</span></span><small class="d-block text-muted">Regular updates</small></div>
                        </div></a></li>
                  </ul>-->
                </li>
              </ul>
            </div>
            <div class="offcanvas-footer"><a class="btn d-block w-100 btn-primary" href="demo-personal-portfolio.html#modal-contact" data-bs-toggle="modal">Contact Us</a></div>
          </div>
        </div>
      </header>

      <!-- Page content-->
      <div class="sidebar-enabled">
        <div class="container">
          <div class="row">
            
            <!-- Sidebar-->
            <div class="sidebar col-lg-3 pt-lg-5">
              <div class="offcanvas offcanvas-collapse">
                
                <div class="offcanvas-header navbar-shadow mb-3">
                  <h5 class="mt-1 mb-0">Sidebar</h5>
                  <button class="btn-close lead" type="button" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="sidebarbarbar">
                  <!-- Search widget-->
                  <div class="widget mb-5">
                    <h3 class="widget-title">Search tutorials</h3>
                    <div class="input-group"><i class="ai-search position-absolute top-50 start-0 translate-middle-y ms-3"></i>
                      <input class="form-control rounded" type="text" placeholder="Search">
                    </div>
                  </div>

                  <div class="widget mb-5">
                    <h3 class="widget-title">Get Started</h3>
                    <ul>
                      <!--<li>
                        <div class="d-flex">
                          <i class="ai-book text-muted mt-2 me-2"></i>
                          <a class="widget-link" onclick="showHide(this)">[+]&nbsp&nbsp</a>
                          <a class="widget-link" href="tutorials.html">Introduction</a>
                        </div>
                        <ul class="sub_ul">
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="tutorials.html#Data_Preparation">Dataset</a>
                          </li>
                          
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="tutorials.html#Model">Model</a>
                          </li>

                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="tutorials.html#Loss_Function">Loss Funtion</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="tutorials.html#Optimizer">Optimizer</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="tutorials.html#Metrics">Metrics</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="tutorials.html#Full_Code">Full Code</a>
                          </li>
                        </ul>
                      </li>-->
                      <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i><a class="widget-link" href="tutorials.html">Installation</a></li>
                    </ul>
                  </div>

                  <div class="widget mb-5">
                    <h3 class="widget-title">Documentation</h3>
                    <ul>
                      <li>
                        <div class="d-flex">
                          <i class="ai-book text-muted mt-2 me-2"></i>
                          <a class="widget-link" onclick="showHide(this)">[+]&nbsp&nbsp</a>
                          <a class="widget-link" href="./metric_AUROC.html">Metrics</a>
                        </div>
                        <ul class="sub_ul">
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./metric_AUROC.html">AUROC</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./metric_PartialAUROC.html">PartialAUROC</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./metric_AUPRC.html">AUPRC</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./metric_AUTKC.html">AUTKC</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./metric_OpenAUC.html">OpenAUC</a>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <div class="d-flex">
                          <i class="ai-book text-muted mt-2 me-2"></i>
                          <a class="widget-link" onclick="showHide(this)">[+]&nbsp&nbsp</a>
                          <a class="widget-link" href="./loss_AUPRC.html">Losses</a>
                        </div>
                        <ul class="sub_ul">
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./loss_AUPRC.html">AUPRC</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./loss_AUTKC.html">AUTKC</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./loss_OpenAUC.html">OpenAUC</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./loss_AUROC.html">AUROC</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./loss_PartialAUROC.html">PartialAUROC</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./loss_AdversarialAUROC.html">AdversarialAUROC</a>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <div class="d-flex">
                          <i class="ai-book text-muted mt-2 me-2"></i>
                          <a class="widget-link" onclick="showHide(this)">[+]&nbsp&nbsp</a>
                          <a class="widget-link" href="./sampler_stratified_sampler.html">Sampler</a>
                        </div>
                        <ul class="sub_ul">
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./sampler_stratified_sampler.html">Stratified Sampler</a>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <div class="d-flex">
                          <i class="ai-book text-muted mt-2 me-2"></i>
                          <a class="widget-link" onclick="showHide(this)">[+]&nbsp&nbsp</a>
                          <a class="widget-link" href="./optimizer_AdvAUCOptimizer.html">Optmizer</a>
                        </div>
                        <ul class="sub_ul">
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./optimizer_AdvAUCOptimizer.html">AdvAUCOptimizer</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./optimizer_ASGDA.html">ASGDA</a>
                          </li>
                          <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i>
                            <a class="widget-link" href="./optimizer_minmax_opt.html">minmax_opt</a>
                          </li>
                        </ul>
                      </li>
                      <!--li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i><a class="widget-link" href="tutorials_install.html">Installation</a></li>-->
                    </ul>
                  </div>

                
                  <div class="widget mb-5">
                    <h3 class="widget-title">Example Projects</h3>
                     <ul>
                      <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i><a class="widget-link" href=" ">Metrics_for_AUROC </a ></li>
                      <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i><a class="widget-link" href="https://github.com/statusrank/XCurve/blob/master/example/example_ipynb/Metrics_for_AUTKC_OpenAUC.ipynb">Metrics_for_AUTKC_OpenAUC </a ></li>
                      <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i><a class="widget-link" href="https://github.com/statusrank/XCurve/blob/master/example/example_ipynb/cifar_10_advAUC.ipynb">cifar_10_advAUC </a ></li>
                      <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i><a class="widget-link" href="https://github.com/statusrank/XCurve/blob/master/example/example_ipynb/cifar_10_auc.ipynb">cifar_10_auc </a ></li>
                      <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i><a class="widget-link" href="https://github.com/statusrank/XCurve/blob/master/example/example_ipynb/cifar_10_mauc.ipynb">cifar_10_mauc </a ></li>
                      <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i><a class="widget-link" href="https://github.com/statusrank/XCurve/blob/master/example/example_ipynb/cifar_10_minmax.ipynb">cifar_10_minmax </a ></li>
                      <li class="d-flex"><i class="ai-book text-muted mt-2 me-2"></i><a class="widget-link" href="https://github.com/statusrank/XCurve/blob/master/example/example_ipynb/cifar_10_pauc.ipynb">cifar_10_pauc </a ></li>
                       </ul>
                  </div>
                </div>
              </div>

            </div>

            <div class="col-lg-9 content py-4">
              <nav aria-label="breadcrumb">
                <ol class="py-1 my-2 breadcrumb">
                  <li class="breadcrumb-item"><a href="tutorials.html">Documentation</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Optimizer</li>
                </ol>
              </nav>

              <h3>AdvAUCOptimizer</h3>
              
              The following class is an optimizer used in conjunction with <b><code>AdversarialAUROC</code></b> Loss: 

              <P></P>

              <pre><code>  CLASS AdvAUCOptimizer(Optimizer): (params, a, b, alpha, lr=required, momentum=0.9, dampening=0, weight_decay=0, nesterov=False)     <a href="https://github.com/statusrank/XCurve/blob/master/XCurve/AUROC/optimizer/AdvAUC_opt.py">[SOURCE]</a></code></pre> 

              <P></P>

              <!--The following functions computer the AUPRC and Recall@K metrics as 
              <a href="https://github.com/statusrank/XCurve/blob/master/XCurve/AUPRC/metrics.py">[SOURCE]</a>:-->

            <!-- nwx-->
            <table class="table">
              <tbody>
                <tr>
                  <th scope="row">
                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                  </th>
                  <td>
                    
                    <!-- <dt><strong>y_true</strong>, int, default=2</dt>
                      <p>Number of components to keep. Should be in 
                        <code class="docutils literal notranslate">
                          <span class="pre">[1,</span> <span class="pre">min(n_samples,</span>
                          <span class="pre">n_features,</span> 
                          <span class="pre">n_targets)]</span>
                        </code>.
                      </p> -->
                    <dt><strong>params (generator)</strong></dt>
                    <p>This is a list or an iterable that contains the parameters of the neural network or model that you want to optimize. These parameters include the weights and biases of the model's layers. The optimizer will update these parameters during the optimization process based on the computed gradients.
                    </p>

                    <dt><strong>a, b, alpha (float)</strong></dt>
                    <p>initial values for a, b, $\alpha$ in instance-wise AUROC loss (Default=0.0).
                    </p>

                    <dt><strong>lr (float)</strong></dt>
                    <p>It determines the step size taken in the direction of the gradient during each optimization step.
                    </p>

                    <dt><strong>momentum (float)</strong></dt>
                    <p>It is a parameter that helps accelerate the convergence by adding a fraction of the previous update vector to the current update (Default=0.9). 
                    </p>

                    <dt><strong>dampening (float)</strong></dt>
                    <p>It is a parameter that can be used to reduce the influence of past updates on the current update when momentum is used (Default=0). 
                    </p>

                    <dt><strong>weight_decay (float)</strong></dt>
                    <p>It is a parameter that represents the coefficient of L2 regularization (Default=0).
                    </p>

                    <dt><strong>nesterov (bool)</strong></dt>
                    <p>It is a parameter that indicates whether to use Nesterov Accelerated Gradient (Default=False).
                    </p>

                  </td>
                </tr>
              </tbody>
            </table>

            <h3>RegAdvAUCOptimizer</h3>

            The following class is an optimizer used in conjunction with <b><code>AdversarialAUROC</code></b> Loss:

            <P></P>
            
            <pre><code>  CLASS RegAdvAUCOptimizer(Optimizer): (params, a, b, alpha, lambda1, lambda2, c1=1, c2=1, gamma=1, lamda=1 ,lr=required)     <a href="https://github.com/statusrank/XCurve/blob/master/XCurve/AUROC/optimizer/AdvAUC_opt.py">[SOURCE]</a></code></pre> 

              <P></P>

              <!--The following functions computer the AUPRC and Recall@K metrics as 
              <a href="https://github.com/statusrank/XCurve/blob/master/XCurve/AUPRC/metrics.py">[SOURCE]</a>:-->

            <!-- nwx-->
            <table class="table">
              <tbody>
                <tr>
                  <th scope="row">
                    <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                  </th>
                  <td>
                    
                    <!-- <dt><strong>y_true</strong>, int, default=2</dt>
                      <p>Number of components to keep. Should be in 
                        <code class="docutils literal notranslate">
                          <span class="pre">[1,</span> <span class="pre">min(n_samples,</span>
                          <span class="pre">n_features,</span> 
                          <span class="pre">n_targets)]</span>
                        </code>.
                      </p> -->
                    <dt><strong>params (generator)</strong></dt>
                    <p>This is a list or an iterable that contains the parameters of the neural network or model that you want to optimize. These parameters include the weights and biases of the model's layers. The optimizer will update these parameters during the optimization process based on the computed gradients.
                    </p>

                    <dt><strong>a, b, alpha (float)</strong></dt>
                    <p>initial values for a, b, $\alpha$ in instance-wise AUROC loss (Default=0.0).
                    </p>

                    <dt><strong>lambda1, lambda2 (float)</strong></dt>
                    <p>initial coefficient values for regularization (Default=1.0).
                    </p>

                    <dt><strong>c1, c2 (float)</strong></dt>
                    <p>These parameters control the momentum updates' exponential decay rates (Default=1.0).
                    </p>

                    <dt><strong>gamma (float)</strong></dt>
                    <p>It is used to scale the gradient updates during optimization. (Default=1.0).
                    </p>

                    <dt><strong>lamda (float)</strong></dt>
                    <p>It is used in the calculations involving $\alpha$ parameter update. (Default=1.0).
                    </p>

                    <dt><strong>lr (float):</strong></dt>
                    <p>It determines the step size taken in the direction of the gradient during each optimization step.
                    </p>

                  </td>
                </tr>
              </tbody>
            </table>

            <h5>Example: </h5>

            <pre><code id="python_code">  from easydict import EasyDict as edict
  from torchvision import transforms
  import torch
  import random
  import numpy as np
  from XCurve.AUROC.dataloaders import StratifiedSampler # for imbalanced dataset sampling
  from XCurve.AUROC.dataloaders import IMBALANCECIFAR10, get_data_loaders # dataloader of Xcurve
  from XCurve.AUROC.losses import AdvAUROCLoss, PGDAdversary
  from XCurve.AUROC.optimizer import AdvAUCOptimizer
  from XCurve.AUROC.models import generate_net # create model or you can adopt any DNN models by Pytorch
  
  seed = 1024
  random.seed(seed)
  torch.manual_seed(seed)
  torch.cuda.manual_seed(seed)
  np.random.seed(seed)
  torch.backends.cudnn.deterministic = True
  torch.backends.cudnn.benchmark = False
  
  # set params to create model
  args = edict({
    "model_type": "resnet18", # (support resnet, densenet121 and mlp)
    "num_classes": 2, # number of class
    "pretrained": None # if the model is pretrained
  })
  # Or you can adopt any DNN models by Pytorch
  model = generate_net(args).cuda() # generate pytorch model 
  
  p_hat = 0.1
  criterion = AdvAUROCLoss(imratio=p_hat)
  ########################
  #  create optimizer    #
  ########################
  optimizer = AdvAUCOptimizer(model.parameters(), 
                              criterion.a, criterion.b, criterion.alpha,
                              lr=0.1, momentum=0.9,
                              weight_decay=1e-5)
  
  transform_train = transforms.Compose([
    transforms.RandomCrop(32, padding=4),
    transforms.ToTensor(),
  ])
  transform_test = transforms.Compose([
    transforms.ToTensor(),
  ])
  
  trainset = IMBALANCECIFAR10(root='dataset',
                                    train=True,
                                    download=True,
                                    transform=transform_train)
  testset = IMBALANCECIFAR10(root='dataset',
                                  train=False,
                                  transform=transform_test)
  
  sampler = StratifiedSampler(trainset.targets,
                              batch_size = 32,
                              rpos = 1,
                              rneg = 10)
  
  train_loader = torch.utils.data.DataLoader(
    trainset,
    batch_size=sampler.real_batch_size,
    shuffle=(sampler is None),
    num_workers=0,
    pin_memory=True,
    sampler=sampler,
    drop_last=True)
  
  # forward of model for one epoch
  model.train()
  lower_limit, upper_limit = 0.0, 1.0
  
  for index, (X, y) in enumerate(train_loader):
    X, y  = X.cuda(), y.cuda()
    # target.shape => [batch_size, ]
    # Note that we ask for the prediction of the model among [0,1] 
    # for any binary (i.e., sigmoid) or multi-class (i.e., softmax) AUROC optimization.
    
    # obtain adversarial examples
    delta = PGDAdversary(model, X, y, criterion, epsilon=8.0/255, alpha=2.0/255, 
                          attack_iters=10, restarts=1, norm='linf')
    adv_input = torch.clamp(X + delta, min=lower_limit, max=upper_limit)
    adv_input.requires_grad_(requires_grad=False)
    # forward
    robust_output = model(adv_input).view_as(y)
    pred = torch.sigmoid(robust_output) # [batch_size, num_classess] when num_classes > 2, o.w. output [batch_size, ] 
    robust_loss = criterion(pred, y)
    if index % 30 == 0:
      print("loss:", robust_loss.item())
    
    # backward
    optimizer.zero_grad()
    robust_loss.backward()
    
    # If U use RegAdvAUROCLoss, firstly U should use `optimizer.record_grad()`, then use `optimizer.step()` !!!!
    # optimizer.record_grad()
    optimizer.step()</code></pre>
              
              <a id="Model"></a>              
              <!-- Submit request-->

          </div>
        </div>
      </div>
    </main>
    <!-- Footer-->
    <footer class="footer bg-dark pt-5 pt-md-6">
      <div class="container pt-3 pt-md-0">
        <div class="row pb-3">
          <div class="col-md-4 mt-n2 pb-3 pb-md-0 mb-4"><a class="d-block mb-3" href="index.html" style="width: 153px;"><img src="img/logo/Xcurve-logo-trans.png" alt="Around"></a>
            <!--<p class="fs-sm text-light opacity-60 pb-2 pb-sm-3">We are working on building a python library to make it easy for researchers to optimize curve-related models. </p>-->
          </div>
          <div class="col-md-2 col-sm-4 ms-auto pb-1 mb-4">
            <div class="widget widget-light">
              <h4 class="widget-title">Quick start</h4>
              <ul>
                <li><a class="widget-link" href="index.html#">Home</a></li>
                <li><a class="widget-link" href="tutorials.html#">Documentation</a></li>
                <!--<li><a class="widget-link" href="doc_dataset.html#">Documentation</a></li>-->
              </ul>
            </div>
          </div>
          <div class="col-lg-2 col-md-3 col-sm-4 pb-1 mb-4">
            <div class="widget widget-light">
              <h4 class="widget-title">Other Links</h4>
              <ul>
                <li><a class="widget-link" href="https://github.com/statusrank/XCurve">Github</a></li>
                <li><a class="widget-link" href="https://pypi.org/project/XCurve/#">Pypi</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-2 col-md-3 col-sm-4 mb-4">
            <div class="widget widget-light">
              <h4 class="widget-title">Our news</h4>
              <ul>
                <li><a class="widget-link" href="lastest_news.html#">Latest papers</a></li>
                <!--<li><a class="widget-link" href="about.html#">Updates</a></li>-->
              </ul>
            </div>
          </div>
        </div>
        <hr class="my-0 border-light">
        <div class="row align-items-center mt-3 py-4">
          <div class="col-md-6 order-md-2 text-md-end mb-3">
            <ul class="list-inline fs-sm mb-0">
              <li class="list-inline-item"><a class="nav-link-style nav-link-light" href="about.html#">Send email to us</a></li>
            </ul>
          </div>
          <div class="col-md-6 order-md-1 mb-3">
            <p class="fs-sm mb-0"><span class="text-light opacity-50 me-1">© All rights reserved. Made by XCurve.</span></p>
          </div>
        </div>
      </div>
    </footer>
  </body>
  <script src='https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js'></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.61.0/lib/codemirror.min.css">
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.61.0/addon/runmode/runmode-standalone.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.61.0/mode/python/python.min.js"></script>
  <script type="text/javascript">
    window.onload = function(){
      var preloader = document.querySelector('.page-loading');
          preloader.classList.remove('active');
          setTimeout(function () {
            preloader.remove();
          }, 100);

        var codeElement = document.getElementById('python_code');
        codeElement.classList.add( 'cm-s-default' );
        var code = codeElement.innerText;

        codeElement.innerHTML = "";

        CodeMirror.runMode(
          code,
          'python',
          codeElement
        );
    };
</script>
</html>